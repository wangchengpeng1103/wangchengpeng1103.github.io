<!DOCTYPE html>
<html lang=en>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>1-出租车数据的基础处理，由gps生成OD（pandas） | Hexo</title>
  <meta property="og:type" content="article">
<meta property="og:title" content="1-出租车数据的基础处理，由gps生成OD（pandas）">
<meta property="og:url" content="http://example.com/2021/01/21/1-%E5%87%BA%E7%A7%9F%E8%BD%A6%E6%95%B0%E6%8D%AE%E7%9A%84%E5%9F%BA%E7%A1%80%E5%A4%84%E7%90%86%EF%BC%8C%E7%94%B1gps%E7%94%9F%E6%88%90OD%EF%BC%88pandas%EF%BC%89/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-01-21T06:51:56.000Z">
<meta property="article:modified_time" content="2021-01-21T06:56:16.515Z">
<meta property="article:author" content="Wang">
<meta name="twitter:card" content="summary">
  <!-- Canonical links -->
  <link rel="canonical" href="http://example.com/2021/01/21/1-%E5%87%BA%E7%A7%9F%E8%BD%A6%E6%95%B0%E6%8D%AE%E7%9A%84%E5%9F%BA%E7%A1%80%E5%A4%84%E7%90%86%EF%BC%8C%E7%94%B1gps%E7%94%9F%E6%88%90OD%EF%BC%88pandas%EF%BC%89/index.html">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 5.3.0"></head>


<body class="main-center" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://github.com/cofess" target="_blank">
          <img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">昵称</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">Web Developer &amp; Designer</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Shenzhen, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="Search" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="Type something..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav ">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">Home</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">Archives</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">Categories</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">Tags</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">Repository</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-books">
          <a href="/books">
            
            <i class="icon icon-book-fill"></i>
            
            <span class="menu-title">Books</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">Links</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">About</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/cofess" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://weibo.com/cofess" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
        <li><a href="https://twitter.com/iwebued" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
        <li><a href="https://www.behance.net/cofess" target="_blank" title="Behance" data-toggle=tooltip data-placement=top><i class="icon icon-behance"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">Board</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>欢迎交流与分享经验!</p>
            </div>
        </div>
    </div>
</div>

    
      

    
      

    
      
    
      
  <div class="widget">
    <h3 class="widget-title">Archive</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a><span class="archive-list-count">4</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/2021/03/03/3-%E8%AE%A2%E5%8D%95%E6%8C%81%E7%BB%AD%E6%97%B6%E9%97%B4%E7%9A%84%E8%AE%A1%E7%AE%97-md/" class="title">3-订单持续时间的计算.md</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-03T13:01:37.000Z" itemprop="datePublished">2021-03-03</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/2021/01/21/1-%E5%87%BA%E7%A7%9F%E8%BD%A6%E6%95%B0%E6%8D%AE%E7%9A%84%E5%9F%BA%E7%A1%80%E5%A4%84%E7%90%86%EF%BC%8C%E7%94%B1gps%E7%94%9F%E6%88%90OD%EF%BC%88pandas%EF%BC%89/" class="title">1-出租车数据的基础处理，由gps生成OD（pandas）</a>
              </p>
              <p class="item-date">
                <time datetime="2021-01-21T06:51:56.000Z" itemprop="datePublished">2021-01-21</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/2021/01/13/k-means%E7%AE%97%E6%B3%95%E6%B5%81%E7%A8%8B/" class="title">k-means算法流程</a>
              </p>
              <p class="item-date">
                <time datetime="2021-01-13T09:49:43.000Z" itemprop="datePublished">2021-01-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/2021/01/11/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87blog/" class="title">我的第一篇blog</a>
              </p>
              <p class="item-date">
                <time datetime="2021-01-11T04:32:21.000Z" itemprop="datePublished">2021-01-11</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/2021/01/09/hello-world/" class="title">Hello World</a>
              </p>
              <p class="item-date">
                <time datetime="2021-01-09T03:31:41.374Z" itemprop="datePublished">2021-01-09</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<main class="main" role="main">
  <div class="content">
  <article id="post-1-出租车数据的基础处理，由gps生成OD（pandas）" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      1-出租车数据的基础处理，由gps生成OD（pandas）
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2021/01/21/1-%E5%87%BA%E7%A7%9F%E8%BD%A6%E6%95%B0%E6%8D%AE%E7%9A%84%E5%9F%BA%E7%A1%80%E5%A4%84%E7%90%86%EF%BC%8C%E7%94%B1gps%E7%94%9F%E6%88%90OD%EF%BC%88pandas%EF%BC%89/" class="article-date">
	  <time datetime="2021-01-21T06:51:56.000Z" itemprop="datePublished">2021-01-21</time>
	</a>
</span>
        
        

        

        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/01/21/1-%E5%87%BA%E7%A7%9F%E8%BD%A6%E6%95%B0%E6%8D%AE%E7%9A%84%E5%9F%BA%E7%A1%80%E5%A4%84%E7%90%86%EF%BC%8C%E7%94%B1gps%E7%94%9F%E6%88%90OD%EF%BC%88pandas%EF%BC%89/#comments" class="article-comment-link">Comments</a></span>
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <p><escape><a id="more"></a></escape></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment">#Read data</span></span><br><span class="line">data = pd.read_csv(<span class="string">r&#x27;data-sample/TaxiData-Sample&#x27;</span>,header = <span class="literal">None</span>)</span><br><span class="line"><span class="comment">#rename the columns for the data</span></span><br><span class="line">data.columns = [<span class="string">&#x27;VehicleNum&#x27;</span>, <span class="string">&#x27;Stime&#x27;</span>, <span class="string">&#x27;Lng&#x27;</span>, <span class="string">&#x27;Lat&#x27;</span>, <span class="string">&#x27;OpenStatus&#x27;</span>, <span class="string">&#x27;Speed&#x27;</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>Lng</th>
      <th>Lat</th>
      <th>OpenStatus</th>
      <th>Speed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>22271</td>
      <td>22:54:04</td>
      <td>114.167000</td>
      <td>22.718399</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>22271</td>
      <td>18:26:26</td>
      <td>114.190598</td>
      <td>22.647800</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22271</td>
      <td>18:35:18</td>
      <td>114.201401</td>
      <td>22.649700</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>22271</td>
      <td>16:02:46</td>
      <td>114.233498</td>
      <td>22.725901</td>
      <td>0</td>
      <td>24</td>
    </tr>
    <tr>
      <th>4</th>
      <td>22271</td>
      <td>21:41:17</td>
      <td>114.233597</td>
      <td>22.720900</td>
      <td>0</td>
      <td>19</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1601302</th>
      <td>23873</td>
      <td>20:20:03</td>
      <td>114.160149</td>
      <td>22.606934</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1601303</th>
      <td>23873</td>
      <td>20:15:13</td>
      <td>114.164551</td>
      <td>22.605118</td>
      <td>1</td>
      <td>48</td>
    </tr>
    <tr>
      <th>1601304</th>
      <td>23873</td>
      <td>20:16:23</td>
      <td>114.168015</td>
      <td>22.606083</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1601305</th>
      <td>23873</td>
      <td>20:16:43</td>
      <td>114.168015</td>
      <td>22.606083</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1601306</th>
      <td>23873</td>
      <td>20:26:39</td>
      <td>114.170647</td>
      <td>22.604383</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1601307 rows × 6 columns</p>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[data[<span class="string">&#x27;VehicleNum&#x27;</span>] == <span class="number">22271</span>]</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>Lng</th>
      <th>Lat</th>
      <th>OpenStatus</th>
      <th>Speed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>22271</td>
      <td>22:54:04</td>
      <td>114.167000</td>
      <td>22.718399</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>22271</td>
      <td>18:26:26</td>
      <td>114.190598</td>
      <td>22.647800</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22271</td>
      <td>18:35:18</td>
      <td>114.201401</td>
      <td>22.649700</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>22271</td>
      <td>16:02:46</td>
      <td>114.233498</td>
      <td>22.725901</td>
      <td>0</td>
      <td>24</td>
    </tr>
    <tr>
      <th>4</th>
      <td>22271</td>
      <td>21:41:17</td>
      <td>114.233597</td>
      <td>22.720900</td>
      <td>0</td>
      <td>19</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1432</th>
      <td>22271</td>
      <td>11:31:09</td>
      <td>114.279404</td>
      <td>22.739000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1433</th>
      <td>22271</td>
      <td>11:33:09</td>
      <td>114.279404</td>
      <td>22.739000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1434</th>
      <td>22271</td>
      <td>10:43:56</td>
      <td>114.279503</td>
      <td>22.739000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1435</th>
      <td>22271</td>
      <td>10:51:48</td>
      <td>114.279503</td>
      <td>22.739201</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1436</th>
      <td>22271</td>
      <td>00:07:41</td>
      <td>114.282700</td>
      <td>22.727800</td>
      <td>0</td>
      <td>23</td>
    </tr>
  </tbody>
</table>
<p>1437 rows × 6 columns</p>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[-(data[<span class="string">&#x27;VehicleNum&#x27;</span>]==<span class="number">22271</span>].head(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>Lng</th>
      <th>Lat</th>
      <th>OpenStatus</th>
      <th>Speed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1437</th>
      <td>35807</td>
      <td>01:53:46</td>
      <td>113.809898</td>
      <td>22.626801</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1438</th>
      <td>35807</td>
      <td>01:43:46</td>
      <td>113.813301</td>
      <td>22.623600</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data=data.sort_values(by=[<span class="string">&#x27;VehicleNum&#x27;</span>,<span class="string">&#x27;Stime&#x27;</span>])</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>Lng</th>
      <th>Lat</th>
      <th>OpenStatus</th>
      <th>Speed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>39</th>
      <td>22271</td>
      <td>00:00:49</td>
      <td>114.266502</td>
      <td>22.728201</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>397</th>
      <td>22271</td>
      <td>00:01:48</td>
      <td>114.266502</td>
      <td>22.728201</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1413</th>
      <td>22271</td>
      <td>00:02:47</td>
      <td>114.266502</td>
      <td>22.728201</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>244</th>
      <td>22271</td>
      <td>00:03:46</td>
      <td>114.266502</td>
      <td>22.728201</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>247</th>
      <td>22271</td>
      <td>00:04:45</td>
      <td>114.268898</td>
      <td>22.729500</td>
      <td>0</td>
      <td>11</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25320</th>
      <td>36934</td>
      <td>23:49:54</td>
      <td>114.056702</td>
      <td>22.595800</td>
      <td>0</td>
      <td>36</td>
    </tr>
    <tr>
      <th>25831</th>
      <td>36934</td>
      <td>23:50:42</td>
      <td>114.060303</td>
      <td>22.603701</td>
      <td>0</td>
      <td>40</td>
    </tr>
    <tr>
      <th>25485</th>
      <td>36934</td>
      <td>23:52:32</td>
      <td>114.069199</td>
      <td>22.614500</td>
      <td>0</td>
      <td>31</td>
    </tr>
    <tr>
      <th>25749</th>
      <td>36934</td>
      <td>23:53:02</td>
      <td>114.067398</td>
      <td>22.618401</td>
      <td>0</td>
      <td>32</td>
    </tr>
    <tr>
      <th>26464</th>
      <td>36934</td>
      <td>23:53:32</td>
      <td>114.067299</td>
      <td>22.621599</td>
      <td>0</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
<p>1601307 rows × 6 columns</p>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data2=data.iloc[<span class="number">2460</span>:<span class="number">2480</span>]</span><br><span class="line">data2</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>Lng</th>
      <th>Lat</th>
      <th>OpenStatus</th>
      <th>Speed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1550423</th>
      <td>22334</td>
      <td>06:27:51</td>
      <td>114.036018</td>
      <td>22.519051</td>
      <td>0</td>
      <td>19</td>
    </tr>
    <tr>
      <th>1549900</th>
      <td>22334</td>
      <td>06:28:11</td>
      <td>114.035248</td>
      <td>22.517817</td>
      <td>0</td>
      <td>25</td>
    </tr>
    <tr>
      <th>1549352</th>
      <td>22334</td>
      <td>06:28:31</td>
      <td>114.035149</td>
      <td>22.517616</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1550422</th>
      <td>22334</td>
      <td>06:28:51</td>
      <td>114.034569</td>
      <td>22.517967</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1547256</th>
      <td>22334</td>
      <td>06:29:11</td>
      <td>114.032349</td>
      <td>22.518984</td>
      <td>0</td>
      <td>21</td>
    </tr>
    <tr>
      <th>1547418</th>
      <td>22334</td>
      <td>06:29:31</td>
      <td>114.031250</td>
      <td>22.519550</td>
      <td>0</td>
      <td>22</td>
    </tr>
    <tr>
      <th>1547419</th>
      <td>22334</td>
      <td>06:29:51</td>
      <td>114.031250</td>
      <td>22.519550</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1547764</th>
      <td>22334</td>
      <td>06:30:11</td>
      <td>114.031250</td>
      <td>22.519550</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1550417</th>
      <td>22334</td>
      <td>06:30:19</td>
      <td>114.031250</td>
      <td>22.519550</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1547416</th>
      <td>22334</td>
      <td>06:30:39</td>
      <td>114.030098</td>
      <td>22.520317</td>
      <td>1</td>
      <td>18</td>
    </tr>
    <tr>
      <th>1547252</th>
      <td>22334</td>
      <td>06:30:59</td>
      <td>114.029480</td>
      <td>22.521549</td>
      <td>1</td>
      <td>35</td>
    </tr>
    <tr>
      <th>1548778</th>
      <td>22334</td>
      <td>06:31:19</td>
      <td>114.030617</td>
      <td>22.523132</td>
      <td>1</td>
      <td>35</td>
    </tr>
    <tr>
      <th>1550084</th>
      <td>22334</td>
      <td>06:31:39</td>
      <td>114.030983</td>
      <td>22.523632</td>
      <td>1</td>
      <td>11</td>
    </tr>
    <tr>
      <th>1548597</th>
      <td>22334</td>
      <td>06:31:59</td>
      <td>114.030983</td>
      <td>22.523632</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1548598</th>
      <td>22334</td>
      <td>06:32:19</td>
      <td>114.031265</td>
      <td>22.524099</td>
      <td>1</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1547257</th>
      <td>22334</td>
      <td>06:32:39</td>
      <td>114.032448</td>
      <td>22.525850</td>
      <td>1</td>
      <td>40</td>
    </tr>
    <tr>
      <th>1547422</th>
      <td>22334</td>
      <td>06:32:59</td>
      <td>114.032501</td>
      <td>22.525917</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1549350</th>
      <td>22334</td>
      <td>06:33:19</td>
      <td>114.032501</td>
      <td>22.525917</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1549351</th>
      <td>22334</td>
      <td>06:33:39</td>
      <td>114.032730</td>
      <td>22.526318</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1550421</th>
      <td>22334</td>
      <td>06:33:59</td>
      <td>114.033730</td>
      <td>22.528099</td>
      <td>1</td>
      <td>40</td>
    </tr>
  </tbody>
</table>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据整体往下平移了一行</span></span><br><span class="line">data2[<span class="string">&#x27;OpenStatus&#x27;</span>].shift()</span><br></pre></td></tr></table></figure>



<pre><code>1550423    NaN
1549900    0.0
1549352    0.0
1550422    0.0
1547256    0.0
1547418    0.0
1547419    0.0
1547764    0.0
1550417    0.0
1547416    1.0
1547252    1.0
1548778    1.0
1550084    1.0
1548597    1.0
1548598    1.0
1547257    1.0
1547422    1.0
1549350    1.0
1549351    1.0
1550421    1.0
Name: OpenStatus, dtype: float64</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#把平移后的数据整体赋值给新的一列OpenStatus1</span></span><br><span class="line">data2[<span class="string">&#x27;OpenStatus1&#x27;</span>]=data2[<span class="string">&#x27;OpenStatus&#x27;</span>].shift()</span><br></pre></td></tr></table></figure>
<pre><code>&lt;ipython-input-59-8e1c0ecd6a11&gt;:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data2[&#39;OpenStatus1&#39;]=data2[&#39;OpenStatus&#39;].shift()</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data2</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>Lng</th>
      <th>Lat</th>
      <th>OpenStatus</th>
      <th>Speed</th>
      <th>OpenStatus1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1550423</th>
      <td>22334</td>
      <td>06:27:51</td>
      <td>114.036018</td>
      <td>22.519051</td>
      <td>0</td>
      <td>19</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1549900</th>
      <td>22334</td>
      <td>06:28:11</td>
      <td>114.035248</td>
      <td>22.517817</td>
      <td>0</td>
      <td>25</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1549352</th>
      <td>22334</td>
      <td>06:28:31</td>
      <td>114.035149</td>
      <td>22.517616</td>
      <td>0</td>
      <td>5</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1550422</th>
      <td>22334</td>
      <td>06:28:51</td>
      <td>114.034569</td>
      <td>22.517967</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1547256</th>
      <td>22334</td>
      <td>06:29:11</td>
      <td>114.032349</td>
      <td>22.518984</td>
      <td>0</td>
      <td>21</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1547418</th>
      <td>22334</td>
      <td>06:29:31</td>
      <td>114.031250</td>
      <td>22.519550</td>
      <td>0</td>
      <td>22</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1547419</th>
      <td>22334</td>
      <td>06:29:51</td>
      <td>114.031250</td>
      <td>22.519550</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1547764</th>
      <td>22334</td>
      <td>06:30:11</td>
      <td>114.031250</td>
      <td>22.519550</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1550417</th>
      <td>22334</td>
      <td>06:30:19</td>
      <td>114.031250</td>
      <td>22.519550</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1547416</th>
      <td>22334</td>
      <td>06:30:39</td>
      <td>114.030098</td>
      <td>22.520317</td>
      <td>1</td>
      <td>18</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1547252</th>
      <td>22334</td>
      <td>06:30:59</td>
      <td>114.029480</td>
      <td>22.521549</td>
      <td>1</td>
      <td>35</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1548778</th>
      <td>22334</td>
      <td>06:31:19</td>
      <td>114.030617</td>
      <td>22.523132</td>
      <td>1</td>
      <td>35</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1550084</th>
      <td>22334</td>
      <td>06:31:39</td>
      <td>114.030983</td>
      <td>22.523632</td>
      <td>1</td>
      <td>11</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1548597</th>
      <td>22334</td>
      <td>06:31:59</td>
      <td>114.030983</td>
      <td>22.523632</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1548598</th>
      <td>22334</td>
      <td>06:32:19</td>
      <td>114.031265</td>
      <td>22.524099</td>
      <td>1</td>
      <td>5</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1547257</th>
      <td>22334</td>
      <td>06:32:39</td>
      <td>114.032448</td>
      <td>22.525850</td>
      <td>1</td>
      <td>40</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1547422</th>
      <td>22334</td>
      <td>06:32:59</td>
      <td>114.032501</td>
      <td>22.525917</td>
      <td>1</td>
      <td>1</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1549350</th>
      <td>22334</td>
      <td>06:33:19</td>
      <td>114.032501</td>
      <td>22.525917</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1549351</th>
      <td>22334</td>
      <td>06:33:39</td>
      <td>114.032730</td>
      <td>22.526318</td>
      <td>1</td>
      <td>4</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1550421</th>
      <td>22334</td>
      <td>06:33:59</td>
      <td>114.033730</td>
      <td>22.528099</td>
      <td>1</td>
      <td>40</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据清洗条件 #1.后者行等于前一行 　　# 2。但前后者行和中间行是不同的 　　# 3。三条数据车牌号相等</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据清洗</span></span><br><span class="line">data = data[-((data[<span class="string">&#x27;OpenStatus&#x27;</span>].shift(-<span class="number">1</span>) == data[<span class="string">&#x27;OpenStatus&#x27;</span>].shift())&amp;</span><br><span class="line">(data[<span class="string">&#x27;OpenStatus&#x27;</span>].shift(-<span class="number">1</span>) != data[<span class="string">&#x27;OpenStatus&#x27;</span>])&amp;</span><br><span class="line">(data[<span class="string">&#x27;VehicleNum&#x27;</span>].shift(-<span class="number">1</span>) == data[<span class="string">&#x27;VehicleNum&#x27;</span>].shift())&amp;</span><br><span class="line">(data[<span class="string">&#x27;VehicleNum&#x27;</span>].shift(-<span class="number">1</span>) == data[<span class="string">&#x27;VehicleNum&#x27;</span>]))]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>Lng</th>
      <th>Lat</th>
      <th>OpenStatus</th>
      <th>Speed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>39</th>
      <td>22271</td>
      <td>00:00:49</td>
      <td>114.266502</td>
      <td>22.728201</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>397</th>
      <td>22271</td>
      <td>00:01:48</td>
      <td>114.266502</td>
      <td>22.728201</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1413</th>
      <td>22271</td>
      <td>00:02:47</td>
      <td>114.266502</td>
      <td>22.728201</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>244</th>
      <td>22271</td>
      <td>00:03:46</td>
      <td>114.266502</td>
      <td>22.728201</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>247</th>
      <td>22271</td>
      <td>00:04:45</td>
      <td>114.268898</td>
      <td>22.729500</td>
      <td>0</td>
      <td>11</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25320</th>
      <td>36934</td>
      <td>23:49:54</td>
      <td>114.056702</td>
      <td>22.595800</td>
      <td>0</td>
      <td>36</td>
    </tr>
    <tr>
      <th>25831</th>
      <td>36934</td>
      <td>23:50:42</td>
      <td>114.060303</td>
      <td>22.603701</td>
      <td>0</td>
      <td>40</td>
    </tr>
    <tr>
      <th>25485</th>
      <td>36934</td>
      <td>23:52:32</td>
      <td>114.069199</td>
      <td>22.614500</td>
      <td>0</td>
      <td>31</td>
    </tr>
    <tr>
      <th>25749</th>
      <td>36934</td>
      <td>23:53:02</td>
      <td>114.067398</td>
      <td>22.618401</td>
      <td>0</td>
      <td>32</td>
    </tr>
    <tr>
      <th>26464</th>
      <td>36934</td>
      <td>23:53:32</td>
      <td>114.067299</td>
      <td>22.621599</td>
      <td>0</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
<p>1598866 rows × 6 columns</p>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#识别OD</span></span><br><span class="line"><span class="comment">#OpenStatus从0变为1，说明上车，是O点，从1变为0，说明下车，是D点 </span></span><br><span class="line"><span class="comment"># 方法</span></span><br><span class="line"><span class="comment"># 将Open Status向上平移一行 赋值给Open Status1 用Open Status1- Open Status得到Status change</span></span><br><span class="line"><span class="comment"># Status change为-1说明是下车点  为1说明是上车点</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">&#x27;OpenStatus1&#x27;</span>]=data[<span class="string">&#x27;OpenStatus&#x27;</span>].shift(-<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>&lt;ipython-input-72-6240087fbc74&gt;:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data[&#39;OpenStatus1&#39;]=data[&#39;OpenStatus&#39;].shift(-1)</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>Lng</th>
      <th>Lat</th>
      <th>OpenStatus</th>
      <th>Speed</th>
      <th>OpenStatus1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>39</th>
      <td>22271</td>
      <td>00:00:49</td>
      <td>114.266502</td>
      <td>22.728201</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>397</th>
      <td>22271</td>
      <td>00:01:48</td>
      <td>114.266502</td>
      <td>22.728201</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1413</th>
      <td>22271</td>
      <td>00:02:47</td>
      <td>114.266502</td>
      <td>22.728201</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>244</th>
      <td>22271</td>
      <td>00:03:46</td>
      <td>114.266502</td>
      <td>22.728201</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>247</th>
      <td>22271</td>
      <td>00:04:45</td>
      <td>114.268898</td>
      <td>22.729500</td>
      <td>0</td>
      <td>11</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25320</th>
      <td>36934</td>
      <td>23:49:54</td>
      <td>114.056702</td>
      <td>22.595800</td>
      <td>0</td>
      <td>36</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>25831</th>
      <td>36934</td>
      <td>23:50:42</td>
      <td>114.060303</td>
      <td>22.603701</td>
      <td>0</td>
      <td>40</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>25485</th>
      <td>36934</td>
      <td>23:52:32</td>
      <td>114.069199</td>
      <td>22.614500</td>
      <td>0</td>
      <td>31</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>25749</th>
      <td>36934</td>
      <td>23:53:02</td>
      <td>114.067398</td>
      <td>22.618401</td>
      <td>0</td>
      <td>32</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>26464</th>
      <td>36934</td>
      <td>23:53:32</td>
      <td>114.067299</td>
      <td>22.621599</td>
      <td>0</td>
      <td>7</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1598866 rows × 7 columns</p>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">&#x27;Statuschange&#x27;</span>]=data[<span class="string">&#x27;OpenStatus1&#x27;</span>]-data[<span class="string">&#x27;OpenStatus&#x27;</span>]</span><br></pre></td></tr></table></figure>
<pre><code>&lt;ipython-input-74-c1d32677d8c5&gt;:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data[&#39;Statuschange&#39;]=data[&#39;OpenStatus1&#39;]-data[&#39;OpenStatus&#39;]</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>Lng</th>
      <th>Lat</th>
      <th>OpenStatus</th>
      <th>Speed</th>
      <th>OpenStatus1</th>
      <th>Statuschange</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>39</th>
      <td>22271</td>
      <td>00:00:49</td>
      <td>114.266502</td>
      <td>22.728201</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>397</th>
      <td>22271</td>
      <td>00:01:48</td>
      <td>114.266502</td>
      <td>22.728201</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1413</th>
      <td>22271</td>
      <td>00:02:47</td>
      <td>114.266502</td>
      <td>22.728201</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>244</th>
      <td>22271</td>
      <td>00:03:46</td>
      <td>114.266502</td>
      <td>22.728201</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>247</th>
      <td>22271</td>
      <td>00:04:45</td>
      <td>114.268898</td>
      <td>22.729500</td>
      <td>0</td>
      <td>11</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25320</th>
      <td>36934</td>
      <td>23:49:54</td>
      <td>114.056702</td>
      <td>22.595800</td>
      <td>0</td>
      <td>36</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>25831</th>
      <td>36934</td>
      <td>23:50:42</td>
      <td>114.060303</td>
      <td>22.603701</td>
      <td>0</td>
      <td>40</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>25485</th>
      <td>36934</td>
      <td>23:52:32</td>
      <td>114.069199</td>
      <td>22.614500</td>
      <td>0</td>
      <td>31</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>25749</th>
      <td>36934</td>
      <td>23:53:02</td>
      <td>114.067398</td>
      <td>22.618401</td>
      <td>0</td>
      <td>32</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>26464</th>
      <td>36934</td>
      <td>23:53:32</td>
      <td>114.067299</td>
      <td>22.621599</td>
      <td>0</td>
      <td>7</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1598866 rows × 8 columns</p>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data.iloc[<span class="number">2920</span>:<span class="number">2940</span>] </span><br><span class="line"><span class="comment">#Statuschange=-1就是下车点</span></span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>Lng</th>
      <th>Lat</th>
      <th>OpenStatus</th>
      <th>Speed</th>
      <th>OpenStatus1</th>
      <th>Statuschange</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1550238</th>
      <td>22334</td>
      <td>09:05:01</td>
      <td>113.982353</td>
      <td>22.553267</td>
      <td>1</td>
      <td>7</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1546888</th>
      <td>22334</td>
      <td>09:05:21</td>
      <td>113.981300</td>
      <td>22.551933</td>
      <td>1</td>
      <td>16</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1550586</th>
      <td>22334</td>
      <td>09:05:41</td>
      <td>113.980217</td>
      <td>22.551600</td>
      <td>1</td>
      <td>25</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1546885</th>
      <td>22334</td>
      <td>09:06:01</td>
      <td>113.978951</td>
      <td>22.552549</td>
      <td>1</td>
      <td>29</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1548246</th>
      <td>22334</td>
      <td>09:06:21</td>
      <td>113.978821</td>
      <td>22.552700</td>
      <td>1</td>
      <td>3</td>
      <td>0.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>1547752</th>
      <td>22334</td>
      <td>09:06:23</td>
      <td>113.978821</td>
      <td>22.552700</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1547739</th>
      <td>22334</td>
      <td>09:06:43</td>
      <td>113.978821</td>
      <td>22.552700</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1549506</th>
      <td>22334</td>
      <td>09:07:03</td>
      <td>113.978821</td>
      <td>22.552700</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1550237</th>
      <td>22334</td>
      <td>09:07:23</td>
      <td>113.979980</td>
      <td>22.551916</td>
      <td>0</td>
      <td>20</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1549326</th>
      <td>22334</td>
      <td>09:07:43</td>
      <td>113.980568</td>
      <td>22.551018</td>
      <td>0</td>
      <td>22</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1548582</th>
      <td>22334</td>
      <td>09:08:03</td>
      <td>113.980370</td>
      <td>22.550800</td>
      <td>0</td>
      <td>5</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1546886</th>
      <td>22334</td>
      <td>09:08:23</td>
      <td>113.980370</td>
      <td>22.550800</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1546887</th>
      <td>22334</td>
      <td>09:08:43</td>
      <td>113.980370</td>
      <td>22.550800</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1547393</th>
      <td>22334</td>
      <td>09:09:03</td>
      <td>113.980370</td>
      <td>22.550800</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1547740</th>
      <td>22334</td>
      <td>09:09:23</td>
      <td>113.980370</td>
      <td>22.550800</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1549874</th>
      <td>22334</td>
      <td>09:09:43</td>
      <td>113.980034</td>
      <td>22.550400</td>
      <td>0</td>
      <td>3</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1547934</th>
      <td>22334</td>
      <td>09:10:03</td>
      <td>113.980400</td>
      <td>22.549667</td>
      <td>0</td>
      <td>11</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1547394</th>
      <td>22334</td>
      <td>09:10:23</td>
      <td>113.981667</td>
      <td>22.548700</td>
      <td>0</td>
      <td>30</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1548082</th>
      <td>22334</td>
      <td>09:10:43</td>
      <td>113.983383</td>
      <td>22.547417</td>
      <td>0</td>
      <td>37</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1549128</th>
      <td>22334</td>
      <td>09:11:03</td>
      <td>113.985199</td>
      <td>22.546000</td>
      <td>0</td>
      <td>41</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data.iloc[<span class="number">2840</span>:<span class="number">2860</span>]</span><br><span class="line"><span class="comment">##Statuschange=-1就是上车点</span></span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>Lng</th>
      <th>Lat</th>
      <th>OpenStatus</th>
      <th>Speed</th>
      <th>OpenStatus1</th>
      <th>Statuschange</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1548646</th>
      <td>22334</td>
      <td>08:37:03</td>
      <td>114.055931</td>
      <td>22.538349</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1550648</th>
      <td>22334</td>
      <td>08:37:45</td>
      <td>114.057198</td>
      <td>22.537832</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1548466</th>
      <td>22334</td>
      <td>08:38:05</td>
      <td>114.057198</td>
      <td>22.537832</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1547826</th>
      <td>22334</td>
      <td>08:38:16</td>
      <td>114.057198</td>
      <td>22.537832</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1548648</th>
      <td>22334</td>
      <td>08:38:36</td>
      <td>114.057198</td>
      <td>22.537832</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1548649</th>
      <td>22334</td>
      <td>08:38:56</td>
      <td>114.057198</td>
      <td>22.537832</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1549017</th>
      <td>22334</td>
      <td>08:39:16</td>
      <td>114.057419</td>
      <td>22.537617</td>
      <td>0</td>
      <td>2</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1550298</th>
      <td>22334</td>
      <td>08:39:20</td>
      <td>114.057419</td>
      <td>22.537617</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1550299</th>
      <td>22334</td>
      <td>08:39:40</td>
      <td>114.057419</td>
      <td>22.537617</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1548145</th>
      <td>22334</td>
      <td>08:40:00</td>
      <td>114.056366</td>
      <td>22.537600</td>
      <td>1</td>
      <td>4</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1548461</th>
      <td>22334</td>
      <td>08:40:20</td>
      <td>114.055763</td>
      <td>22.537500</td>
      <td>1</td>
      <td>7</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1550639</th>
      <td>22334</td>
      <td>08:40:40</td>
      <td>114.052902</td>
      <td>22.535633</td>
      <td>1</td>
      <td>71</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1550460</th>
      <td>22334</td>
      <td>08:41:20</td>
      <td>114.055031</td>
      <td>22.534634</td>
      <td>1</td>
      <td>27</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1549754</th>
      <td>22334</td>
      <td>08:42:00</td>
      <td>114.054131</td>
      <td>22.531282</td>
      <td>1</td>
      <td>27</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1548139</th>
      <td>22334</td>
      <td>08:42:20</td>
      <td>114.052231</td>
      <td>22.531218</td>
      <td>1</td>
      <td>32</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1547119</th>
      <td>22334</td>
      <td>08:42:40</td>
      <td>114.048935</td>
      <td>22.531601</td>
      <td>1</td>
      <td>39</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1549380</th>
      <td>22334</td>
      <td>08:43:00</td>
      <td>114.046364</td>
      <td>22.531584</td>
      <td>1</td>
      <td>46</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1547440</th>
      <td>22334</td>
      <td>08:43:20</td>
      <td>114.043404</td>
      <td>22.531384</td>
      <td>1</td>
      <td>55</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1548608</th>
      <td>22334</td>
      <td>08:43:40</td>
      <td>114.040535</td>
      <td>22.531082</td>
      <td>1</td>
      <td>52</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1548601</th>
      <td>22334</td>
      <td>08:44:00</td>
      <td>114.037697</td>
      <td>22.530916</td>
      <td>1</td>
      <td>47</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[(data[<span class="string">&#x27;Statuschange&#x27;</span>]==<span class="number">1</span>) | (data[<span class="string">&#x27;Statuschange&#x27;</span>]==-<span class="number">1</span>)]</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>Lng</th>
      <th>Lat</th>
      <th>OpenStatus</th>
      <th>Speed</th>
      <th>OpenStatus1</th>
      <th>Statuschange</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>136</th>
      <td>22271</td>
      <td>23:53:08</td>
      <td>114.205704</td>
      <td>22.720400</td>
      <td>0</td>
      <td>47</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1548741</th>
      <td>22334</td>
      <td>00:00:52</td>
      <td>114.111130</td>
      <td>22.576750</td>
      <td>1</td>
      <td>13</td>
      <td>0.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>1548351</th>
      <td>22334</td>
      <td>00:07:44</td>
      <td>114.080498</td>
      <td>22.554182</td>
      <td>0</td>
      <td>11</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1549620</th>
      <td>22334</td>
      <td>00:17:58</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>1</td>
      <td>2</td>
      <td>0.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>1547182</th>
      <td>22334</td>
      <td>00:18:56</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>459073</th>
      <td>36805</td>
      <td>23:20:04</td>
      <td>114.133530</td>
      <td>22.617550</td>
      <td>1</td>
      <td>15</td>
      <td>0.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>458104</th>
      <td>36805</td>
      <td>23:35:55</td>
      <td>114.112968</td>
      <td>22.549601</td>
      <td>0</td>
      <td>9</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>458416</th>
      <td>36805</td>
      <td>23:42:55</td>
      <td>114.089500</td>
      <td>22.538067</td>
      <td>1</td>
      <td>51</td>
      <td>0.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>455681</th>
      <td>36805</td>
      <td>23:46:12</td>
      <td>114.091217</td>
      <td>22.540768</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>453987</th>
      <td>36805</td>
      <td>23:53:33</td>
      <td>114.120354</td>
      <td>22.544300</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
      <td>-1.0</td>
    </tr>
  </tbody>
</table>
<p>30242 rows × 8 columns</p>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#shift(-1)这一行要和原本的哪一行车牌要相同</span></span><br><span class="line">data[((data[<span class="string">&#x27;Statuschange&#x27;</span>]==<span class="number">1</span>) | (data[<span class="string">&#x27;Statuschange&#x27;</span>]==-<span class="number">1</span>)) &amp; (data[<span class="string">&#x27;VehicleNum&#x27;</span>]==data[<span class="string">&#x27;VehicleNum&#x27;</span>].shift(-<span class="number">1</span>))]</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>Lng</th>
      <th>Lat</th>
      <th>OpenStatus</th>
      <th>Speed</th>
      <th>OpenStatus1</th>
      <th>Statuschange</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1548741</th>
      <td>22334</td>
      <td>00:00:52</td>
      <td>114.111130</td>
      <td>22.576750</td>
      <td>1</td>
      <td>13</td>
      <td>0.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>1548351</th>
      <td>22334</td>
      <td>00:07:44</td>
      <td>114.080498</td>
      <td>22.554182</td>
      <td>0</td>
      <td>11</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1549620</th>
      <td>22334</td>
      <td>00:17:58</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>1</td>
      <td>2</td>
      <td>0.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>1547182</th>
      <td>22334</td>
      <td>00:18:56</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1547627</th>
      <td>22334</td>
      <td>00:44:47</td>
      <td>114.056236</td>
      <td>22.633383</td>
      <td>1</td>
      <td>3</td>
      <td>0.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>459073</th>
      <td>36805</td>
      <td>23:20:04</td>
      <td>114.133530</td>
      <td>22.617550</td>
      <td>1</td>
      <td>15</td>
      <td>0.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>458104</th>
      <td>36805</td>
      <td>23:35:55</td>
      <td>114.112968</td>
      <td>22.549601</td>
      <td>0</td>
      <td>9</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>458416</th>
      <td>36805</td>
      <td>23:42:55</td>
      <td>114.089500</td>
      <td>22.538067</td>
      <td>1</td>
      <td>51</td>
      <td>0.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>455681</th>
      <td>36805</td>
      <td>23:46:12</td>
      <td>114.091217</td>
      <td>22.540768</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>453987</th>
      <td>36805</td>
      <td>23:53:33</td>
      <td>114.120354</td>
      <td>22.544300</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
      <td>-1.0</td>
    </tr>
  </tbody>
</table>
<p>30016 rows × 8 columns</p>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 结果赋给oddata</span></span><br><span class="line">oddata=data[((data[<span class="string">&#x27;Statuschange&#x27;</span>]==<span class="number">1</span>) | (data[<span class="string">&#x27;Statuschange&#x27;</span>]==-<span class="number">1</span>)) &amp; (data[<span class="string">&#x27;VehicleNum&#x27;</span>]==data[<span class="string">&#x27;VehicleNum&#x27;</span>].shift(-<span class="number">1</span>))]</span><br><span class="line">oddata</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>Lng</th>
      <th>Lat</th>
      <th>OpenStatus</th>
      <th>Speed</th>
      <th>OpenStatus1</th>
      <th>Statuschange</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1548741</th>
      <td>22334</td>
      <td>00:00:52</td>
      <td>114.111130</td>
      <td>22.576750</td>
      <td>1</td>
      <td>13</td>
      <td>0.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>1548351</th>
      <td>22334</td>
      <td>00:07:44</td>
      <td>114.080498</td>
      <td>22.554182</td>
      <td>0</td>
      <td>11</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1549620</th>
      <td>22334</td>
      <td>00:17:58</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>1</td>
      <td>2</td>
      <td>0.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>1547182</th>
      <td>22334</td>
      <td>00:18:56</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1547627</th>
      <td>22334</td>
      <td>00:44:47</td>
      <td>114.056236</td>
      <td>22.633383</td>
      <td>1</td>
      <td>3</td>
      <td>0.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>459073</th>
      <td>36805</td>
      <td>23:20:04</td>
      <td>114.133530</td>
      <td>22.617550</td>
      <td>1</td>
      <td>15</td>
      <td>0.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>458104</th>
      <td>36805</td>
      <td>23:35:55</td>
      <td>114.112968</td>
      <td>22.549601</td>
      <td>0</td>
      <td>9</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>458416</th>
      <td>36805</td>
      <td>23:42:55</td>
      <td>114.089500</td>
      <td>22.538067</td>
      <td>1</td>
      <td>51</td>
      <td>0.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>455681</th>
      <td>36805</td>
      <td>23:46:12</td>
      <td>114.091217</td>
      <td>22.540768</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>453987</th>
      <td>36805</td>
      <td>23:53:33</td>
      <td>114.120354</td>
      <td>22.544300</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
      <td>-1.0</td>
    </tr>
  </tbody>
</table>
<p>30016 rows × 8 columns</p>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oddata[[<span class="string">&#x27;VehicleNum&#x27;</span>,<span class="string">&#x27;Stime&#x27;</span>,<span class="string">&#x27;Lng&#x27;</span>,<span class="string">&#x27;Lat&#x27;</span>,<span class="string">&#x27;Statuschange&#x27;</span>]]</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>Lng</th>
      <th>Lat</th>
      <th>Statuschange</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1548741</th>
      <td>22334</td>
      <td>00:00:52</td>
      <td>114.111130</td>
      <td>22.576750</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>1548351</th>
      <td>22334</td>
      <td>00:07:44</td>
      <td>114.080498</td>
      <td>22.554182</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1549620</th>
      <td>22334</td>
      <td>00:17:58</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>1547182</th>
      <td>22334</td>
      <td>00:18:56</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1547627</th>
      <td>22334</td>
      <td>00:44:47</td>
      <td>114.056236</td>
      <td>22.633383</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>459073</th>
      <td>36805</td>
      <td>23:20:04</td>
      <td>114.133530</td>
      <td>22.617550</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>458104</th>
      <td>36805</td>
      <td>23:35:55</td>
      <td>114.112968</td>
      <td>22.549601</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>458416</th>
      <td>36805</td>
      <td>23:42:55</td>
      <td>114.089500</td>
      <td>22.538067</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>455681</th>
      <td>36805</td>
      <td>23:46:12</td>
      <td>114.091217</td>
      <td>22.540768</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>453987</th>
      <td>36805</td>
      <td>23:53:33</td>
      <td>114.120354</td>
      <td>22.544300</td>
      <td>-1.0</td>
    </tr>
  </tbody>
</table>
<p>30016 rows × 5 columns</p>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#提取有用的列，双[]</span></span><br><span class="line">oddata=oddata[[<span class="string">&#x27;VehicleNum&#x27;</span>,<span class="string">&#x27;Stime&#x27;</span>,<span class="string">&#x27;Lng&#x27;</span>,<span class="string">&#x27;Lat&#x27;</span>,<span class="string">&#x27;Statuschange&#x27;</span>]]</span><br><span class="line">oddata</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>Lng</th>
      <th>Lat</th>
      <th>Statuschange</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1548741</th>
      <td>22334</td>
      <td>00:00:52</td>
      <td>114.111130</td>
      <td>22.576750</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>1548351</th>
      <td>22334</td>
      <td>00:07:44</td>
      <td>114.080498</td>
      <td>22.554182</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1549620</th>
      <td>22334</td>
      <td>00:17:58</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>1547182</th>
      <td>22334</td>
      <td>00:18:56</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1547627</th>
      <td>22334</td>
      <td>00:44:47</td>
      <td>114.056236</td>
      <td>22.633383</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>459073</th>
      <td>36805</td>
      <td>23:20:04</td>
      <td>114.133530</td>
      <td>22.617550</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>458104</th>
      <td>36805</td>
      <td>23:35:55</td>
      <td>114.112968</td>
      <td>22.549601</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>458416</th>
      <td>36805</td>
      <td>23:42:55</td>
      <td>114.089500</td>
      <td>22.538067</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>455681</th>
      <td>36805</td>
      <td>23:46:12</td>
      <td>114.091217</td>
      <td>22.540768</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>453987</th>
      <td>36805</td>
      <td>23:53:33</td>
      <td>114.120354</td>
      <td>22.544300</td>
      <td>-1.0</td>
    </tr>
  </tbody>
</table>
<p>30016 rows × 5 columns</p>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#修改列名 注意格式</span></span><br><span class="line">oddata.columns=[<span class="string">&#x27;VehicleNum&#x27;</span>,<span class="string">&#x27;Stime&#x27;</span>,<span class="string">&#x27;SLng&#x27;</span>,<span class="string">&#x27;SLat&#x27;</span>,<span class="string">&#x27;Statuschange&#x27;</span>]</span><br><span class="line">oddata</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>SLng</th>
      <th>SLat</th>
      <th>Statuschange</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1548741</th>
      <td>22334</td>
      <td>00:00:52</td>
      <td>114.111130</td>
      <td>22.576750</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>1548351</th>
      <td>22334</td>
      <td>00:07:44</td>
      <td>114.080498</td>
      <td>22.554182</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1549620</th>
      <td>22334</td>
      <td>00:17:58</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>1547182</th>
      <td>22334</td>
      <td>00:18:56</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1547627</th>
      <td>22334</td>
      <td>00:44:47</td>
      <td>114.056236</td>
      <td>22.633383</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>459073</th>
      <td>36805</td>
      <td>23:20:04</td>
      <td>114.133530</td>
      <td>22.617550</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>458104</th>
      <td>36805</td>
      <td>23:35:55</td>
      <td>114.112968</td>
      <td>22.549601</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>458416</th>
      <td>36805</td>
      <td>23:42:55</td>
      <td>114.089500</td>
      <td>22.538067</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>455681</th>
      <td>36805</td>
      <td>23:46:12</td>
      <td>114.091217</td>
      <td>22.540768</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>453987</th>
      <td>36805</td>
      <td>23:53:33</td>
      <td>114.120354</td>
      <td>22.544300</td>
      <td>-1.0</td>
    </tr>
  </tbody>
</table>
<p>30016 rows × 5 columns</p>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#新建终点时间经纬度，值是起点上移一行，因为不是终点就是起点</span></span><br><span class="line">oddata[<span class="string">&#x27;Elng&#x27;</span>]=oddata[<span class="string">&#x27;SLng&#x27;</span>].shift(-<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>&lt;ipython-input-110-74375a3c7844&gt;:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  oddata[&#39;Elng&#39;]=oddata[&#39;SLng&#39;].shift(-1)</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">oddata[<span class="string">&#x27;ELat&#x27;</span>]=oddata[<span class="string">&#x27;SLat&#x27;</span>].shift(-<span class="number">1</span>)</span><br><span class="line">oddata[<span class="string">&#x27;Etime&#x27;</span>]=oddata[<span class="string">&#x27;Stime&#x27;</span>].shift(-<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>&lt;ipython-input-111-7dbbfabccb1e&gt;:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  oddata[&#39;ELat&#39;]=oddata[&#39;SLat&#39;].shift(-1)</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oddata</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>SLng</th>
      <th>SLat</th>
      <th>Statuschange</th>
      <th>Elng</th>
      <th>ELat</th>
      <th>Etime</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1548741</th>
      <td>22334</td>
      <td>00:00:52</td>
      <td>114.111130</td>
      <td>22.576750</td>
      <td>-1.0</td>
      <td>114.080498</td>
      <td>22.554182</td>
      <td>00:07:44</td>
    </tr>
    <tr>
      <th>1548351</th>
      <td>22334</td>
      <td>00:07:44</td>
      <td>114.080498</td>
      <td>22.554182</td>
      <td>1.0</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>00:17:58</td>
    </tr>
    <tr>
      <th>1549620</th>
      <td>22334</td>
      <td>00:17:58</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>-1.0</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>00:18:56</td>
    </tr>
    <tr>
      <th>1547182</th>
      <td>22334</td>
      <td>00:18:56</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>1.0</td>
      <td>114.056236</td>
      <td>22.633383</td>
      <td>00:44:47</td>
    </tr>
    <tr>
      <th>1547627</th>
      <td>22334</td>
      <td>00:44:47</td>
      <td>114.056236</td>
      <td>22.633383</td>
      <td>-1.0</td>
      <td>114.091637</td>
      <td>22.543200</td>
      <td>02:38:35</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>459073</th>
      <td>36805</td>
      <td>23:20:04</td>
      <td>114.133530</td>
      <td>22.617550</td>
      <td>-1.0</td>
      <td>114.112968</td>
      <td>22.549601</td>
      <td>23:35:55</td>
    </tr>
    <tr>
      <th>458104</th>
      <td>36805</td>
      <td>23:35:55</td>
      <td>114.112968</td>
      <td>22.549601</td>
      <td>1.0</td>
      <td>114.089500</td>
      <td>22.538067</td>
      <td>23:42:55</td>
    </tr>
    <tr>
      <th>458416</th>
      <td>36805</td>
      <td>23:42:55</td>
      <td>114.089500</td>
      <td>22.538067</td>
      <td>-1.0</td>
      <td>114.091217</td>
      <td>22.540768</td>
      <td>23:46:12</td>
    </tr>
    <tr>
      <th>455681</th>
      <td>36805</td>
      <td>23:46:12</td>
      <td>114.091217</td>
      <td>22.540768</td>
      <td>1.0</td>
      <td>114.120354</td>
      <td>22.544300</td>
      <td>23:53:33</td>
    </tr>
    <tr>
      <th>453987</th>
      <td>36805</td>
      <td>23:53:33</td>
      <td>114.120354</td>
      <td>22.544300</td>
      <td>-1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>30016 rows × 8 columns</p>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#只要起点</span></span><br><span class="line">oddata[oddata[<span class="string">&#x27;Statuschange&#x27;</span>]==<span class="number">1</span>]</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>SLng</th>
      <th>SLat</th>
      <th>Statuschange</th>
      <th>Elng</th>
      <th>ELat</th>
      <th>Etime</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1548351</th>
      <td>22334</td>
      <td>00:07:44</td>
      <td>114.080498</td>
      <td>22.554182</td>
      <td>1.0</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>00:17:58</td>
    </tr>
    <tr>
      <th>1547182</th>
      <td>22334</td>
      <td>00:18:56</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>1.0</td>
      <td>114.056236</td>
      <td>22.633383</td>
      <td>00:44:47</td>
    </tr>
    <tr>
      <th>1547511</th>
      <td>22334</td>
      <td>02:38:35</td>
      <td>114.091637</td>
      <td>22.543200</td>
      <td>1.0</td>
      <td>114.093498</td>
      <td>22.554382</td>
      <td>02:46:52</td>
    </tr>
    <tr>
      <th>1547789</th>
      <td>22334</td>
      <td>03:58:46</td>
      <td>114.038818</td>
      <td>22.553232</td>
      <td>1.0</td>
      <td>114.052299</td>
      <td>22.604366</td>
      <td>04:13:57</td>
    </tr>
    <tr>
      <th>1547764</th>
      <td>22334</td>
      <td>06:30:11</td>
      <td>114.031250</td>
      <td>22.519550</td>
      <td>1.0</td>
      <td>114.067886</td>
      <td>22.521299</td>
      <td>06:41:19</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>454832</th>
      <td>36805</td>
      <td>22:49:01</td>
      <td>114.114365</td>
      <td>22.550632</td>
      <td>1.0</td>
      <td>114.115753</td>
      <td>22.557550</td>
      <td>22:50:30</td>
    </tr>
    <tr>
      <th>456900</th>
      <td>36805</td>
      <td>22:51:55</td>
      <td>114.115402</td>
      <td>22.558083</td>
      <td>1.0</td>
      <td>114.118713</td>
      <td>22.547882</td>
      <td>23:03:03</td>
    </tr>
    <tr>
      <th>453986</th>
      <td>36805</td>
      <td>23:03:42</td>
      <td>114.118484</td>
      <td>22.547867</td>
      <td>1.0</td>
      <td>114.133530</td>
      <td>22.617550</td>
      <td>23:20:04</td>
    </tr>
    <tr>
      <th>458104</th>
      <td>36805</td>
      <td>23:35:55</td>
      <td>114.112968</td>
      <td>22.549601</td>
      <td>1.0</td>
      <td>114.089500</td>
      <td>22.538067</td>
      <td>23:42:55</td>
    </tr>
    <tr>
      <th>455681</th>
      <td>36805</td>
      <td>23:46:12</td>
      <td>114.091217</td>
      <td>22.540768</td>
      <td>1.0</td>
      <td>114.120354</td>
      <td>22.544300</td>
      <td>23:53:33</td>
    </tr>
  </tbody>
</table>
<p>15022 rows × 8 columns</p>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#要筛选车牌也要一样 不然蹿车</span></span><br><span class="line">oddata[(oddata[<span class="string">&#x27;Statuschange&#x27;</span>]==<span class="number">1</span>)&amp;(oddata[<span class="string">&#x27;VehicleNum&#x27;</span>]==oddata[<span class="string">&#x27;VehicleNum&#x27;</span>].shift(-<span class="number">1</span>))]</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>SLng</th>
      <th>SLat</th>
      <th>Statuschange</th>
      <th>Elng</th>
      <th>ELat</th>
      <th>Etime</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1548351</th>
      <td>22334</td>
      <td>00:07:44</td>
      <td>114.080498</td>
      <td>22.554182</td>
      <td>1.0</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>00:17:58</td>
    </tr>
    <tr>
      <th>1547182</th>
      <td>22334</td>
      <td>00:18:56</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>1.0</td>
      <td>114.056236</td>
      <td>22.633383</td>
      <td>00:44:47</td>
    </tr>
    <tr>
      <th>1547511</th>
      <td>22334</td>
      <td>02:38:35</td>
      <td>114.091637</td>
      <td>22.543200</td>
      <td>1.0</td>
      <td>114.093498</td>
      <td>22.554382</td>
      <td>02:46:52</td>
    </tr>
    <tr>
      <th>1547789</th>
      <td>22334</td>
      <td>03:58:46</td>
      <td>114.038818</td>
      <td>22.553232</td>
      <td>1.0</td>
      <td>114.052299</td>
      <td>22.604366</td>
      <td>04:13:57</td>
    </tr>
    <tr>
      <th>1547764</th>
      <td>22334</td>
      <td>06:30:11</td>
      <td>114.031250</td>
      <td>22.519550</td>
      <td>1.0</td>
      <td>114.067886</td>
      <td>22.521299</td>
      <td>06:41:19</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>454832</th>
      <td>36805</td>
      <td>22:49:01</td>
      <td>114.114365</td>
      <td>22.550632</td>
      <td>1.0</td>
      <td>114.115753</td>
      <td>22.557550</td>
      <td>22:50:30</td>
    </tr>
    <tr>
      <th>456900</th>
      <td>36805</td>
      <td>22:51:55</td>
      <td>114.115402</td>
      <td>22.558083</td>
      <td>1.0</td>
      <td>114.118713</td>
      <td>22.547882</td>
      <td>23:03:03</td>
    </tr>
    <tr>
      <th>453986</th>
      <td>36805</td>
      <td>23:03:42</td>
      <td>114.118484</td>
      <td>22.547867</td>
      <td>1.0</td>
      <td>114.133530</td>
      <td>22.617550</td>
      <td>23:20:04</td>
    </tr>
    <tr>
      <th>458104</th>
      <td>36805</td>
      <td>23:35:55</td>
      <td>114.112968</td>
      <td>22.549601</td>
      <td>1.0</td>
      <td>114.089500</td>
      <td>22.538067</td>
      <td>23:42:55</td>
    </tr>
    <tr>
      <th>455681</th>
      <td>36805</td>
      <td>23:46:12</td>
      <td>114.091217</td>
      <td>22.540768</td>
      <td>1.0</td>
      <td>114.120354</td>
      <td>22.544300</td>
      <td>23:53:33</td>
    </tr>
  </tbody>
</table>
<p>14818 rows × 8 columns</p>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#删除一列</span></span><br><span class="line">oddata.drop(<span class="string">&#x27;Statuschange&#x27;</span>,axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>SLng</th>
      <th>SLat</th>
      <th>Elng</th>
      <th>ELat</th>
      <th>Etime</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1548741</th>
      <td>22334</td>
      <td>00:00:52</td>
      <td>114.111130</td>
      <td>22.576750</td>
      <td>114.080498</td>
      <td>22.554182</td>
      <td>00:07:44</td>
    </tr>
    <tr>
      <th>1548351</th>
      <td>22334</td>
      <td>00:07:44</td>
      <td>114.080498</td>
      <td>22.554182</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>00:17:58</td>
    </tr>
    <tr>
      <th>1549620</th>
      <td>22334</td>
      <td>00:17:58</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>00:18:56</td>
    </tr>
    <tr>
      <th>1547182</th>
      <td>22334</td>
      <td>00:18:56</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>114.056236</td>
      <td>22.633383</td>
      <td>00:44:47</td>
    </tr>
    <tr>
      <th>1547627</th>
      <td>22334</td>
      <td>00:44:47</td>
      <td>114.056236</td>
      <td>22.633383</td>
      <td>114.091637</td>
      <td>22.543200</td>
      <td>02:38:35</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>459073</th>
      <td>36805</td>
      <td>23:20:04</td>
      <td>114.133530</td>
      <td>22.617550</td>
      <td>114.112968</td>
      <td>22.549601</td>
      <td>23:35:55</td>
    </tr>
    <tr>
      <th>458104</th>
      <td>36805</td>
      <td>23:35:55</td>
      <td>114.112968</td>
      <td>22.549601</td>
      <td>114.089500</td>
      <td>22.538067</td>
      <td>23:42:55</td>
    </tr>
    <tr>
      <th>458416</th>
      <td>36805</td>
      <td>23:42:55</td>
      <td>114.089500</td>
      <td>22.538067</td>
      <td>114.091217</td>
      <td>22.540768</td>
      <td>23:46:12</td>
    </tr>
    <tr>
      <th>455681</th>
      <td>36805</td>
      <td>23:46:12</td>
      <td>114.091217</td>
      <td>22.540768</td>
      <td>114.120354</td>
      <td>22.544300</td>
      <td>23:53:33</td>
    </tr>
    <tr>
      <th>453987</th>
      <td>36805</td>
      <td>23:53:33</td>
      <td>114.120354</td>
      <td>22.544300</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>30016 rows × 7 columns</p>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oddate=oddata[(oddata[<span class="string">&#x27;Statuschange&#x27;</span>]==<span class="number">1</span>)&amp;(oddata[<span class="string">&#x27;VehicleNum&#x27;</span>]==oddata[<span class="string">&#x27;VehicleNum&#x27;</span>].shift(-<span class="number">1</span>))].drop(<span class="string">&#x27;Statuschange&#x27;</span>,axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oddate</span><br></pre></td></tr></table></figure>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleNum</th>
      <th>Stime</th>
      <th>SLng</th>
      <th>SLat</th>
      <th>Elng</th>
      <th>ELat</th>
      <th>Etime</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1548351</th>
      <td>22334</td>
      <td>00:07:44</td>
      <td>114.080498</td>
      <td>22.554182</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>00:17:58</td>
    </tr>
    <tr>
      <th>1547182</th>
      <td>22334</td>
      <td>00:18:56</td>
      <td>114.084915</td>
      <td>22.540850</td>
      <td>114.056236</td>
      <td>22.633383</td>
      <td>00:44:47</td>
    </tr>
    <tr>
      <th>1547511</th>
      <td>22334</td>
      <td>02:38:35</td>
      <td>114.091637</td>
      <td>22.543200</td>
      <td>114.093498</td>
      <td>22.554382</td>
      <td>02:46:52</td>
    </tr>
    <tr>
      <th>1547789</th>
      <td>22334</td>
      <td>03:58:46</td>
      <td>114.038818</td>
      <td>22.553232</td>
      <td>114.052299</td>
      <td>22.604366</td>
      <td>04:13:57</td>
    </tr>
    <tr>
      <th>1547764</th>
      <td>22334</td>
      <td>06:30:11</td>
      <td>114.031250</td>
      <td>22.519550</td>
      <td>114.067886</td>
      <td>22.521299</td>
      <td>06:41:19</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>454832</th>
      <td>36805</td>
      <td>22:49:01</td>
      <td>114.114365</td>
      <td>22.550632</td>
      <td>114.115753</td>
      <td>22.557550</td>
      <td>22:50:30</td>
    </tr>
    <tr>
      <th>456900</th>
      <td>36805</td>
      <td>22:51:55</td>
      <td>114.115402</td>
      <td>22.558083</td>
      <td>114.118713</td>
      <td>22.547882</td>
      <td>23:03:03</td>
    </tr>
    <tr>
      <th>453986</th>
      <td>36805</td>
      <td>23:03:42</td>
      <td>114.118484</td>
      <td>22.547867</td>
      <td>114.133530</td>
      <td>22.617550</td>
      <td>23:20:04</td>
    </tr>
    <tr>
      <th>458104</th>
      <td>36805</td>
      <td>23:35:55</td>
      <td>114.112968</td>
      <td>22.549601</td>
      <td>114.089500</td>
      <td>22.538067</td>
      <td>23:42:55</td>
    </tr>
    <tr>
      <th>455681</th>
      <td>36805</td>
      <td>23:46:12</td>
      <td>114.091217</td>
      <td>22.540768</td>
      <td>114.120354</td>
      <td>22.544300</td>
      <td>23:53:33</td>
    </tr>
  </tbody>
</table>
<p>14818 rows × 7 columns</p>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#encoding=&#x27;utf-8_sig&#x27;防止中文乱码 </span></span><br><span class="line">oddate.to_csv(<span class="string">r&#x27;oddate.csv&#x27;</span>,index=<span class="literal">None</span>,encoding=<span class="string">&#x27;utf-8_sig&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://example.com/2021/01/21/1-%E5%87%BA%E7%A7%9F%E8%BD%A6%E6%95%B0%E6%8D%AE%E7%9A%84%E5%9F%BA%E7%A1%80%E5%A4%84%E7%90%86%EF%BC%8C%E7%94%B1gps%E7%94%9F%E6%88%90OD%EF%BC%88pandas%EF%BC%89/" title="1-出租车数据的基础处理，由gps生成OD（pandas）" target="_blank" rel="external">http://example.com/2021/01/21/1-%E5%87%BA%E7%A7%9F%E8%BD%A6%E6%95%B0%E6%8D%AE%E7%9A%84%E5%9F%BA%E7%A1%80%E5%A4%84%E7%90%86%EF%BC%8C%E7%94%B1gps%E7%94%9F%E6%88%90OD%EF%BC%88pandas%EF%BC%89/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/cofess" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/cofess" target="_blank"><span class="text-dark">昵称</span><small class="ml-1x">Web Developer &amp; Designer</small></a></h3>
        <div>个人简介。</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="vcomments"></div>
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2021/03/03/3-%E8%AE%A2%E5%8D%95%E6%8C%81%E7%BB%AD%E6%97%B6%E9%97%B4%E7%9A%84%E8%AE%A1%E7%AE%97-md/" title="3-订单持续时间的计算.md"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;Newer</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2021/01/13/k-means%E7%AE%97%E6%B3%95%E6%B5%81%E7%A8%8B/" title="k-means算法流程"><span>Older&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>$</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div>
    
  </div>
  </div>
</nav>
  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>Maybe you could buy me a cup of coffee.</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/alipayimg.png" alt="Scan Qrcode" title="Scan" />
              </div>
              <p class="text-muted mv">Scan this qrcode</p>
              <p class="text-grey">Open alipay app scan this qrcode, buy me a coffee!</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/wechatpayimg.png" alt="Scan Qrcode" title="Scan" />
              </div>
              <p class="text-muted mv">Scan this qrcode</p>
              <p class="text-grey">Open wechat app scan this qrcode, buy me a coffee!</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> alipay</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> wechat payment</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/cofess" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://weibo.com/cofess" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
        <li><a href="https://twitter.com/iwebued" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
        <li><a href="https://www.behance.net/cofess" target="_blank" title="Behance" data-toggle=tooltip data-placement=top><i class="icon icon-behance"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
        	Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   




   
    
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine"></script>
  <script type="text/javascript">
  var GUEST = ['nick', 'mail', 'link'];
  var meta = 'nick,mail,link';
  meta = meta.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#vcomments',
    verify: false,
    notify: false,
    appId: '',
    appKey: '',
    placeholder: 'Just go go',
    avatar: 'mm',
    meta: meta,
    pageSize: '10' || 10,
    visitor: false
  });
  </script>

     







</body>
</html>